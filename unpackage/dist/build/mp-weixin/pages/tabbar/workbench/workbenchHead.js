(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/tabbar/workbench/workbenchHead"],{"4a3c":function(t,e,n){},"59bb":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=s(n("a34a")),i=n("2f62"),r=s(n("adf4"));function s(t){return t&&t.__esModule?t:{default:t}}function a(t,e,n,o,i,r,s){try{var a=t[r](s),c=a.value}catch(u){return void n(u)}a.done?e(c):Promise.resolve(c).then(o,i)}function c(t){return function(){var e=this,n=arguments;return new Promise(function(o,i){var r=t.apply(e,n);function s(t){a(r,o,i,s,c,"next",t)}function c(t){a(r,o,i,s,c,"throw",t)}s(void 0)})}}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),o.forEach(function(e){d(t,e,n[e])})}return t}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var l=function(){return n.e("pages/tabbar/workbench/headTodo").then(n.bind(null,"ff40"))},f=function(){return n.e("pages/tabbar/workbench/peopleList").then(n.bind(null,"d655"))},_=function(){return n.e("pages/tabbar/workbench/plan").then(n.bind(null,"4a11"))},h=function(){return n.e("pages/tabbar/workbench/errManage").then(n.bind(null,"11e3"))},p={data:function(){return{is_unfold:!1,list:[{name:"李小吧",age:"22",tag:["电工学徒"],address:"深圳市龙华区大浪街",status:"准备中",status_no:2},{name:"李小吧",age:"22",tag:["电工学徒"],address:"深圳市龙华区大浪街",status:"确认能来",status_no:1},{name:"李小吧",age:"22",tag:["电工学徒"],address:"深圳市龙华区大浪街",status:"确认不来",status_no:0},{name:"李小吧",age:"22",tag:["电工学徒"],address:"深圳市龙华区大浪街",status:"等待确认",status_no:3}],swiperHeight:"",project_detail:{},downOption:{auto:!1},upOption:{auto:!1,isLock:!0},current_swiper:0,form_data:{startTime:"",address:"",points:"",description:""},tab_list:[{name:"待办事项",data:[],is_rquest:!1},{name:"人员列表",data:[],is_rquest:!1},{name:"生产计划",data:[],is_rquest:!1},{name:"异常管理",data:[],is_rquest:!1}],TabCur:0,scrollLeft:0,no_work:!1}},props:{location:{default:null}},components:{headTodo:l,peopleList:f,plan:_,errManage:h},mounted:function(){var e=this;t.$on("refreshJwt",function(t){e.init()}),t.$on("taskToWork",function(t){e.init()}),this.init()},beforeDestroy:function(){t.$off("refreshJwt"),t.$off("taskToWork")},computed:u({},(0,i.mapState)(["bgt_c_task","bgt_ct_id"]),(0,i.mapGetters)(["user_role","id"]),{person_list:function(){var t=this,e=this.$utils._get(this.project_detail,"personList",[]);return e.forEach(function(e){t.$set(e,"custom_wages","")}),e},project:function(){return this.$utils._get(this.project_detail,"project",{})},c_CustomBar:function(){return this.CustomBar},current_bgt_c_task:function(){var t=this;return this.bgt_c_task.find(function(e){return e.id==t.bgt_ct_id})}}),watch:{bgt_ct_id:function(t){console.log(t),this.current_swiper=this.bgt_c_task.findIndex(function(e){return e.id==t}),this.init()},location:{handler:function(t){console.log("wlocation",t),t&&(this.form_data.address=t.address,this.form_data.points="[".concat(t.latitude,",").concat(t.longitude,"]"),console.log(this.form_data))},deep:!0}},methods:{init:function(){console.log(this.bgt_c_task,this.bgt_ct_id),this.get_head_project()},set_form_data:function(){var t=this,e=this.bgt_c_task.findIndex(function(e){return e.id==t.bgt_ct_id});this.current_swiper=e,this.form_data.startTime=this.$utils.format_date(this.$_.get(this.bgt_c_task[e],"startTime","")),this.form_data.address=this.$utils._get(this.bgt_c_task[e],"address",""),this.form_data.points=this.$utils._get(this.bgt_c_task[e],"points",""),this.form_data.description=this.bgt_c_task[e].description},get_head_project:function(t){var e=this;this.$http.get("personwx.headproject/1.0/",{pid:this.id,isFinish:"0"}).then(function(n){if(console.log(n),"0"===e.$utils._get(n,"data.code")){if(0==n.data.data.length)return void(e.no_work=!0);e.no_work=!1,e.$store.commit("set_bgt_c_task",e.$utils._get(n,"data.data",[])),""==e.bgt_ct_id&&e.$store.commit("set_bgt_ct_id",e.$utils._get(n,"data.data[0].id","")),e.get_project_detail(t)}})},get_project_detail:function(t){var e=this;this.set_form_data(),this.$http.get("personwx.projectDetail/1.0/",{id:this.bgt_ct_id}).then(function(n){"0"===e.$utils._get(n,"data.code")&&(console.log(n),e.project_detail=e.$utils._get(n,"data.data",{}),"function"===typeof t&&t(),e.$nextTick(function(){e.get_swiper_c_height()}))})},get_swiper_c_height:function(){var e=this,n=t.createSelectorQuery().in(this);n.select("#content"+this.current_swiper).boundingClientRect(function(t){console.log("得到布局位置信息"+JSON.stringify(t)),console.log("节点离页面顶部的距离为"+t.top),e.swiperHeight=t.height+"px"}).exec()},status_class:function(t){return 1===t?"text-green":2===t?"text-blue":3===t?"text-orange":"text-grey"},status_text:function(t){return 1===t?"确认能来":2===t?"准备中":3===t?"等待确认":"确认不来"},expectedPlace:function(t){var e="";try{e=JSON.parse(t).join("")}catch(n){}return e},goto_detail:function(e){t.navigateTo({url:"/pages/auditDetail/auditDetail?id=".concat(this.project.id,"&pid=").concat(e.id,"&isWork=true")})},deliveryPeriod:function(t){return this.$utils.format_date(t)},case_more:function(){var t=this;this.is_unfold=!this.is_unfold,this.$nextTick(function(){t.get_swiper_c_height()})},downCallback:function(t){t.resetUpScroll()},upCallback:function(t){var e=this;setTimeout(function(){e.get_head_project(function(){t.endSuccess(e.person_list.length,!1)})},300)},goto_recruiting:function(){this.show_modal=!1,t.navigateTo({url:"/pages/personList/personList?recId=".concat(this.project.id,"&proId=").concat(this.project.pid)})},swiperChange:function(t){console.log(t),this.current_swiper=t.detail.current;var e=this.$utils._get(this.bgt_c_task[this.current_swiper],"id","");this.$store.commit("set_bgt_ct_id",e)},before_send_start:function(){var e=this;if(this.$_.every(this.person_list,function(t){return""!==t.custom_wages})){t.showLoading({title:"加载中",mask:!0});var n=[];this.person_list.forEach(function(t){n.push({id:t.id,value:t.custom_wages})}),this.$http.post("personwx.updatePersonWages/1.0/",{WageDate:JSON.stringify(n)}).then(function(n){t.hideLoading(),e.send_start()})}else t.showToast({title:"请输入每位人员工价",duration:2e3,icon:"none"}),console.log(this.person_list)},send_start:function(){var e=this;t.showModal({title:"提示",content:"确认输入的开工信息是否有误",confirmText:"确认开工",success:function(t){t.confirm?(console.log("用户点击确定"),e.$http.post("personwx.updateprojectinfo/1.0/",{startTime:e.form_data.startTime,address:e.form_data.address,points:e.form_data.points,description:e.form_data.description,id:e.bgt_ct_id}).then(function(t){console.log(t);var n={id:e.bgt_ct_id,address:e.form_data.address,points:e.form_data.points,startTime:e.form_data.startTime};console.log(n),e.$http.post("personwx.startproject/1.0/",n).then(function(t){console.log(t),e.get_head_project()})})):t.cancel&&console.log("用户点击取消")}})},dpDateChange:function(t){this.form_data.startTime=t.detail.value},chooseLocation:function(){var t,e="CLABZ-JECLX-JDZ43-TAZKO-FNNM7-NVF2G",n="智造劳务";if(""==this.form_data.points)t="";else{var o=JSON.parse(this.form_data.points);t=JSON.stringify({latitude:o[0],longitude:o[1]})}wx.navigateTo({url:"plugin://chooseLocation/index?key=".concat(e,"&referer=").concat(n,"&location=").concat(t)})},tabSelect:function(t){this.TabCur=t.currentTarget.dataset.id,this.scrollLeft=60*(t.currentTarget.dataset.id-1)},goto_log:function(){t.navigateTo({url:"/pages/tabbar/workbench/logReport/logReport"})},goto_error:function(){t.navigateTo({url:"/pages/tabbar/workbench/errorReport/errorReport"})},goto_rating:function(){t.navigateTo({url:"/pages/tabbar/workbench/ratingList/ratingList"})},scan:function(){var e=c(o.default.mark(function e(){var n;return o.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.checkPermission();case 2:if(n=e.sent,1===n){e.next=5;break}return e.abrupt("return");case 5:t.scanCode({success:function(t){console.log("条码类型："+t.scanType),console.log("条码内容："+t.result)},fail:function(t){console.log(t)}});case 6:case"end":return e.stop()}},e,this)}));function n(){return e.apply(this,arguments)}return n}(),checkPermission:function(){var e=c(o.default.mark(function e(n){var i;return o.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!r.default.isIOS){e.next=6;break}return e.next=3,r.default.requestIOS("camera");case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,r.default.requestAndroid("android.permission.CAMERA");case 8:e.t0=e.sent;case 9:return i=e.t0,null===i||1===i?i=1:t.showModal({content:"需要相机权限",confirmText:"设置",success:function(t){t.confirm&&r.default.gotoAppSetting()}}),e.abrupt("return",i);case 12:case"end":return e.stop()}},e,this)}));function n(t){return e.apply(this,arguments)}return n}(),finish_task:function(){var e=this;t.showModal({title:"提示",content:"辛苦了，确认任务结案？",confirmText:"确认结案",success:function(n){n.confirm?(console.log("用户点击确定"),e.$http.post("personwx.projectfinish/1.0/",{id:e.bgt_ct_id}).then(function(n){console.log(n),"0"==e.$_.get(n,"data.code","")?t.showToast({title:"任务结案成功",duration:2e3,icon:"success",success:function(){t.$emit("refreshList"),e.init(),setTimeout(function(){t.switchTab({url:"/pages/tabbar/task/task"})},300)}}):t.showToast({title:"任务结案失败",duration:2e3})})):n.cancel&&console.log("用户点击取消")}})},goto_work:function(){t.switchTab({url:"/pages/tabbar/task/task"})}}};e.default=p}).call(this,n("543d")["default"])},"6e1f":function(t,e,n){"use strict";n.r(e);var o=n("59bb"),i=n.n(o);for(var r in o)"default"!==r&&function(t){n.d(e,t,function(){return o[t]})}(r);e["default"]=i.a},ade3:function(t,e,n){"use strict";var o,i=function(){var t=this,e=t.$createElement,n=(t._self._c,t.__map(t.bgt_c_task,function(e,n){var o=t.deliveryPeriod(e.deliveryPeriod);return{$orig:t.__get_orig(e),m0:o}}));t.$mp.data=Object.assign({},{$root:{l0:n}})},r=[];n.d(e,"b",function(){return i}),n.d(e,"c",function(){return r}),n.d(e,"a",function(){return o})},b82b:function(t,e,n){"use strict";var o=n("4a3c"),i=n.n(o);i.a},e574:function(t,e,n){"use strict";n.r(e);var o=n("ade3"),i=n("6e1f");for(var r in i)"default"!==r&&function(t){n.d(e,t,function(){return i[t]})}(r);n("b82b");var s,a=n("f0c5"),c=Object(a["a"])(i["default"],o["b"],o["c"],!1,null,"7473494e",null,!1,o["a"],s);e["default"]=c.exports}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'pages/tabbar/workbench/workbenchHead-create-component',
    {
        'pages/tabbar/workbench/workbenchHead-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("e574"))
        })
    },
    [['pages/tabbar/workbench/workbenchHead-create-component']]
]);
